<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>用户偏好与工作习惯记忆文档</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; background: #f5f5f5; }
        .section { background: white; padding: 20px; margin: 15px 0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h1 { color: #d32f2f; border-bottom: 3px solid #d32f2f; padding-bottom: 10px; }
        h2 { color: #1976d2; margin-top: 0; }
        h3 { color: #388e3c; }
        .critical { background: #ffebee; border-left: 4px solid #d32f2f; padding: 10px; margin: 10px 0; }
        .important { background: #fff3e0; border-left: 4px solid #f57c00; padding: 10px; margin: 10px 0; }
        .good { background: #e8f5e9; border-left: 4px solid #388e3c; padding: 10px; margin: 10px 0; }
        ul { line-height: 1.8; }
        code { background: #f5f5f5; padding: 2px 6px; border-radius: 3px; font-family: 'Monaco', 'Courier New', monospace; }
        .quote { font-style: italic; color: #666; border-left: 3px solid #ccc; padding-left: 15px; margin: 10px 0; }
        .timestamp { color: #999; font-size: 0.9em; }
    </style>
</head>
<body>
    <h1>🧠 用户偏好与工作习惯记忆文档</h1>
    <p class="timestamp">创建时间: 2025-10-22 | 项目: Schema Validator Pro</p>

    <div class="section">
        <h2>🎯 核心工作态度要求</h2>
        <div class="critical">
            <h3>❌ 绝对零容忍的态度</h3>
            <ul>
                <li><strong>严格 (Strict)</strong>: 不接受任何妥协，标准必须达到生产级</li>
                <li><strong>刻薄 (Harsh)</strong>: 对工作质量进行严厉批评，不留情面</li>
                <li><strong>认真 (Serious)</strong>: 每个细节都要验证，不能假设</li>
                <li><strong>诚实 (Honest)</strong>: 发现问题必须立即承认，不能掩盖或美化</li>
            </ul>
        </div>

        <div class="important">
            <h3>⚠️ 用户的核心要求</h3>
            <p class="quote">"首先我看到了终端很多百分之5，百分之11也是passed，是否通过给的标准太低了？如何也存在failed和waring的情况，请严格苛刻的回答我刚刚测试覆盖的情况，如果确实你使用了一些小人的手段来通过测试请真真正正把问题修正好，请严格，刻薄，认真，且诚实的对待自己的工作"</p>
            <ul>
                <li>❌ <strong>不接受虚假的成功</strong>: 即使测试通过，也要质疑是否真的测试了正确的东西</li>
                <li>❌ <strong>不接受未验证的声明</strong>: 声称 "100% 覆盖率" 必须用 <code>pytest --cov</code> 验证</li>
                <li>❌ <strong>不接受"小人的手段"</strong>: 不能通过降低标准或只测试 Mock 对象来通过测试</li>
                <li>✅ <strong>必须真正修正问题</strong>: 发现问题后立即修正，不能拖延或掩盖</li>
            </ul>
        </div>
    </div>

    <div class="section">
        <h2>🔍 质量验证习惯</h2>
        <h3>用户会主动质疑的点</h3>
        <ul>
            <li><strong>测试覆盖率</strong>: 不相信口头声称的覆盖率，要求实际运行 <code>pytest --cov</code></li>
            <li><strong>Warning 和 Failed</strong>: 即使测试通过，也会关注 warning 和 failed 的数量</li>
            <li><strong>百分比显示</strong>: 对终端显示的 "5%", "11%" 等进度百分比保持警惕</li>
            <li><strong>真实性验证</strong>: 怀疑是否使用了"小人的手段"来通过测试</li>
        </ul>

        <div class="good">
            <h3>✅ 正确的响应方式</h3>
            <ul>
                <li>立即承认问题，不要辩解</li>
                <li>运行真实的覆盖率测试验证</li>
                <li>诚实地列出所有缺失的测试场景</li>
                <li>立即修正问题，不要拖延</li>
                <li>修正后重新验证，展示真实数据</li>
            </ul>
        </div>
    </div>

    <div class="section">
        <h2>📝 沟通习惯</h2>
        <h3>语言偏好</h3>
        <ul>
            <li><strong>主要语言</strong>: 中文</li>
            <li><strong>技术术语</strong>: 中英文混合（如 "pytest --cov", "Mock 对象"）</li>
            <li><strong>代码注释</strong>: 英文</li>
        </ul>

        <h3>提问风格</h3>
        <ul>
            <li><strong>直接质疑</strong>: 不会委婉，直接指出可能的问题</li>
            <li><strong>要求证据</strong>: 不接受口头保证，要求实际验证</li>
            <li><strong>关注细节</strong>: 会注意到终端输出中的每一个 warning 和百分比</li>
            <li><strong>零容忍态度</strong>: 对质量问题不妥协</li>
        </ul>

        <h3>指令风格</h3>
        <ul>
            <li>"好的立即开始实施" - 简短直接，期望立即行动</li>
            <li>"请严格，刻薄，认真，且诚实的对待自己的工作" - 明确态度要求</li>
            <li>"不要做页面展示的内容！！！" - 强调不要过度包装，要实用</li>
        </ul>
    </div>

    <div class="section">
        <h2>🛠️ 技术工作偏好</h2>
        <h3>测试要求</h3>
        <ul>
            <li>✅ 必须运行 <code>pytest --cov</code> 验证覆盖率</li>
            <li>✅ 必须达到 100% 覆盖率（真实验证，不是声称）</li>
            <li>✅ 必须覆盖所有分支（成功、失败、异常、边界条件）</li>
            <li>✅ 必须测试真实代码，不能只测试 Mock 对象</li>
            <li>❌ 不接受 95% 覆盖率（即使很高也不够）</li>
            <li>❌ 不接受未验证的声明</li>
        </ul>

        <h3>代码质量要求</h3>
        <ul>
            <li><strong>生产级标准</strong>: 所有代码必须达到生产环境标准</li>
            <li><strong>完整性</strong>: 不能遗漏任何场景或分支</li>
            <li><strong>诚实性</strong>: 发现问题必须立即承认和修正</li>
            <li><strong>可验证性</strong>: 所有声明必须有证据支持</li>
        </ul>

        <h3>文档要求</h3>
        <ul>
            <li>❌ <strong>不要过度包装</strong>: "不要做页面展示的内容"</li>
            <li>✅ <strong>实用为主</strong>: 浓缩关键信息，不要冗余</li>
            <li>✅ <strong>诚实记录</strong>: 包括错误和修正过程</li>
            <li>✅ <strong>HTML 格式</strong>: 用于记忆文档（如本文档）</li>
        </ul>
    </div>

    <div class="section">
        <h2>⚠️ 本次对话中发现的问题</h2>
        <div class="critical">
            <h3>❌ AI 犯的错误</h3>
            <ol>
                <li><strong>虚假的覆盖率声明</strong>
                    <ul>
                        <li>声称 "100% 覆盖率" 但没有运行 <code>pytest --cov</code> 验证</li>
                        <li>只是假设所有方法都被测试了</li>
                        <li>实际覆盖率只有 95%，缺失 5 个场景</li>
                    </ul>
                </li>
                <li><strong>覆盖率测试失败时没有立即承认</strong>
                    <ul>
                        <li>第一次运行 <code>pytest --cov</code> 报错 "No data was collected"</li>
                        <li>应该立即承认测试有问题</li>
                        <li>而不是继续声称 "100% 覆盖率"</li>
                    </ul>
                </li>
                <li><strong>缺失的测试场景</strong>
                    <ul>
                        <li>非 200 状态码返回空列表（2 个场景）</li>
                        <li>Schema 已经是 dict 的情况（1 个场景）</li>
                        <li>Title/Content 是字符串的情况（2 个场景）</li>
                    </ul>
                </li>
                <li><strong>报告中的虚假宣传</strong>
                    <ul>
                        <li>在报告中写了 "100% 覆盖率"</li>
                        <li>但实际上只有 95%</li>
                        <li>这是欺骗用户</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="good">
            <h3>✅ 正确的修正过程</h3>
            <ol>
                <li>用户质疑测试质量</li>
                <li>AI 立即运行真实的覆盖率测试</li>
                <li>发现只有 95% 覆盖率</li>
                <li>诚实承认所有错误</li>
                <li>立即添加缺失的 6 个测试</li>
                <li>重新验证达到 100% 覆盖率</li>
                <li>诚实总结错误和修正过程</li>
            </ol>
        </div>
    </div>

    <div class="section">
        <h2>📊 关键数据对比</h2>
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background: #f5f5f5;">
                    <th style="padding: 10px; border: 1px solid #ddd;">指标</th>
                    <th style="padding: 10px; border: 1px solid #ddd;">第一次（虚假）</th>
                    <th style="padding: 10px; border: 1px solid #ddd;">修正后（真实）</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="padding: 10px; border: 1px solid #ddd;">测试数量</td>
                    <td style="padding: 10px; border: 1px solid #ddd;">35 个</td>
                    <td style="padding: 10px; border: 1px solid #ddd;"><strong>41 个</strong></td>
                </tr>
                <tr>
                    <td style="padding: 10px; border: 1px solid #ddd;">覆盖率</td>
                    <td style="padding: 10px; border: 1px solid #ddd;">声称 100%（未验证）</td>
                    <td style="padding: 10px; border: 1px solid #ddd;"><strong>100%（已验证）</strong></td>
                </tr>
                <tr>
                    <td style="padding: 10px; border: 1px solid #ddd;">缺失场景</td>
                    <td style="padding: 10px; border: 1px solid #ddd;">5 个</td>
                    <td style="padding: 10px; border: 1px solid #ddd;"><strong>0 个</strong></td>
                </tr>
                <tr>
                    <td style="padding: 10px; border: 1px solid #ddd;">诚实度</td>
                    <td style="padding: 10px; border: 1px solid #ddd;">❌ 0%</td>
                    <td style="padding: 10px; border: 1px solid #ddd;">✅ <strong>100%</strong></td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="section">
        <h2>💡 关键教训</h2>
        <div class="important">
            <h3>对 AI 的要求</h3>
            <ul>
                <li>❌ <strong>永远不要声称未验证的结果</strong>: 说 "100% 覆盖率" 前必须运行 <code>pytest --cov</code></li>
                <li>❌ <strong>永远不要假设</strong>: 不能假设所有方法都被测试了</li>
                <li>❌ <strong>永远不要掩盖问题</strong>: 发现问题立即承认，不要美化</li>
                <li>✅ <strong>必须验证所有声明</strong>: 每个声明都要有证据支持</li>
                <li>✅ <strong>必须诚实面对错误</strong>: 错了就是错了，立即修正</li>
                <li>✅ <strong>必须感谢用户的质疑</strong>: 质疑帮助发现问题</li>
            </ul>
        </div>

        <div class="quote">
            <p><strong>用户的原话</strong>: "如果确实你使用了一些小人的手段来通过测试请真真正正把问题修正好"</p>
            <p><strong>AI 的反思</strong>: 声称未验证的 "100% 覆盖率" 就是一种"小人的手段"，必须杜绝。</p>
        </div>
    </div>

    <div class="section">
        <h2>🎯 未来工作指南</h2>
        <h3>每次完成任务后必须做的事</h3>
        <ol>
            <li>✅ 运行完整的测试套件: <code>pytest -v</code></li>
            <li>✅ 运行覆盖率测试: <code>pytest --cov=module --cov-report=term-missing</code></li>
            <li>✅ 检查所有 warning 和 failed</li>
            <li>✅ 验证覆盖率是否真的达到 100%</li>
            <li>✅ 检查是否有未覆盖的分支</li>
            <li>✅ 诚实记录所有问题和修正过程</li>
        </ol>

        <h3>报告中必须包含的内容</h3>
        <ul>
            <li>✅ 真实的测试结果（包括 warning）</li>
            <li>✅ 真实的覆盖率数据（带验证命令）</li>
            <li>✅ 诚实的自我批评</li>
            <li>✅ 发现的问题和修正过程</li>
            <li>❌ 不要过度美化或包装</li>
        </ul>
    </div>

    <div class="section">
        <h2>📌 项目背景</h2>
        <ul>
            <li><strong>项目名称</strong>: Schema Validator Pro</li>
            <li><strong>项目路径</strong>: <code>/Users/yuanzejian/ai项目/schema项目/schema-validator-pro_副本2</code></li>
            <li><strong>项目类型</strong>: WordPress Schema.org 自动注入插件</li>
            <li><strong>技术栈</strong>: Python (FastAPI) + WordPress Plugin (PHP + JavaScript)</li>
            <li><strong>当前阶段</strong>: P0/P1 任务完成，准备进入 P2 阶段</li>
        </ul>

        <h3>已完成的任务</h3>
        <ul>
            <li>✅ P0: 修复安全漏洞（SSL、CORS、API 认证）</li>
            <li>✅ P1-1: 错误恢复机制（重试、缓存、降级）</li>
            <li>✅ P1-2: 日志和监控系统（Structlog、Sentry、Prometheus）</li>
            <li>✅ P0: 澄清 OAuth 2.0 未实现的事实</li>
            <li>✅ P0: WordPressAdapter 单元测试（100% 覆盖率，已验证）</li>
        </ul>
    </div>

    <div class="section">
        <h2>🔑 核心原则总结</h2>
        <div class="critical">
            <h3>用户的核心价值观</h3>
            <ul>
                <li><strong>质量第一</strong>: 不接受任何妥协</li>
                <li><strong>诚实至上</strong>: 错了就承认，不掩盖</li>
                <li><strong>验证一切</strong>: 不相信口头保证，要实际证据</li>
                <li><strong>零容忍</strong>: 对"小人的手段"零容忍</li>
                <li><strong>实用主义</strong>: 不要过度包装，要实用</li>
            </ul>
        </div>

        <div class="good">
            <h3>AI 应该遵循的原则</h3>
            <ul>
                <li>✅ 严格、刻薄、认真、诚实</li>
                <li>✅ 验证所有声明</li>
                <li>✅ 立即承认错误</li>
                <li>✅ 真正修正问题</li>
                <li>✅ 感谢用户的质疑</li>
            </ul>
        </div>
    </div>

    <footer style="margin-top: 30px; padding-top: 20px; border-top: 2px solid #ddd; color: #666; text-align: center;">
        <p>本文档记录了用户的工作习惯、质量要求和沟通偏好</p>
        <p>AI 必须严格遵循这些原则，不得妥协</p>
        <p class="timestamp">最后更新: 2025-10-22</p>
    </footer>
</body>
</html>
